# Source Tables Schema



Located under `TECHCATALYST_DE` schema 

![ERD](images/ERD.jpg)



# Insurance Tables 

![image-20240703124542416](images/image-20240703124542416.png)

# Target Tables Schema 

Create the following target tables in your schema 

![image-20240703125113397](images/image-20240703125113397.png)





Examples for `TATWAN`

```sql
create or replace table techcatalyst_de.tatwan.fact_accidents {
 .....
}
```



![image-20231103214302985](images/image-20231103214302985.png)

**DDL scripts assuming` CAPSTONE.TATWAN` schema. Make sure to use your OWN schema.**

```sql
create or replace TABLE CAPSTONE.TATWAN.FACT_ACCIDENTS (
	ACCIDENT_ID NUMBER(38,0),
	POLICYHOLDER_ID NUMBER(38,0),
	VEHICLE_ID NUMBER(38,0),
	STATE_ID NUMBER(38,0),
	BODY_STYLE_ID NUMBER(38,0),
	ACCIDENT_TYPE_ID NUMBER(38,0),
	GENDER_MARITALSTATUS_ID NUMBER(38,0),
	VEHICLE_USECODE_ID VARCHAR(16777216),
	ACCIDENT_DATE DATE,
	VEHICLE_YEAR VARCHAR(16777216),
	POLICYHOLDER_BIRTHDATE DATE,
	ESTIMATED_COST FLOAT,
	ACTUAL_REPAIR_COST FLOAT,
	AT_FAULT BOOLEAN,
	IS_DUI BOOLEAN,
	COVERAGE_STATUS VARCHAR(16777216)
);

create or replace TABLE CAPSTONE.TATWAN.DIM_ACCIDENT_TYPE (
	ACCIDENT_TYPE_ID NUMBER(38,0),
	ACCIDENT_TYPE VARCHAR(16777216)
);

create or replace TABLE CAPSTONE.TATWAN.DIM_BODY_STYLE (
	BODY_STYLE_ID NUMBER(38,0),
	BODY_STYLE VARCHAR(16777216)
);

create or replace TABLE CAPSTONE.TATWAN.DIM_GENDER_MARITAL (
	GENDER_MARITALSTATUS_ID NUMBER(38,0),
	GENDER_MARITAL_STATUS VARCHAR(16777216)
);

create or replace TABLE CAPSTONE.TATWAN.DIM_POLICYHOLDER (
	POLICYHOLDER_ID NUMBER(38,0),
	FIRST_NAME VARCHAR(16777216),
	LAST_NAME VARCHAR(16777216),
	ADDRESS VARCHAR(16777216)
);

create or replace TABLE CAPSTONE.TATWAN.DIM_STATES (
	STATE_ID NUMBER(38,0),
	STATE VARCHAR(16777216)
);

create or replace TABLE CAPSTONE.TATWAN.DIM_VEHICLE_USE (
	VEHICLE_USECODE_ID VARCHAR(16777216),
	VEHICLE_USE VARCHAR(16777216)
);

```

